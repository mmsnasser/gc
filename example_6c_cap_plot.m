clear
%%
% In this example, the function 
% cap = capgc (et,etp,alphav,deltav,m,ell,mp,alpha)
% is used to compute the capacity of the generalized condenser (B,E,delta)
% where
% 1)  B=C (the complex plane) and hence ell=0
% 2)  E=E1 U E2 where E1 is the interior of the circle |z|=1 and E2 is the
% interior of the circle |z-a|=r.
% 3)  delta=[0 1];
% 4)  For this case, E is bounded and m'=m=2, G is unbounded
% 
% The exact capacity for this case is known and given by
%  cap = 2/(1+sqrt(1-4*r/((1+a-r)*(a+r-1))))-1;
%
%
%
%
cap_BisC = [
                      0.01          1.10159079458606
                      0.05          1.53501792786249
                       0.1          1.84977034648629
                      0.15          2.10445695686978
                       0.2           2.3357303800877
                      0.25          2.55774808360451
                       0.3          2.77854244706646
                      0.35          3.00399502861134
                       0.4          3.23935691206182
                      0.45          3.49009173427341
                       0.5           3.7625688384233
                      0.55          4.06486942648867
                       0.6          4.40796311403767
                      0.65          4.80767539177396
                       0.7          5.28832253231332
                      0.75          5.89012307048722
                       0.8          6.68623773111496
                      0.85          7.82900565739845
                       0.9          9.71216711586397
                     0.925          11.2823114329788
                      0.95          13.8979388427025
                      0.97          18.0221709137804
                      0.98          22.1205212152025
                     0.985          25.5699730215243
                      0.99           31.350007274889
                      ];
%
% 
cap_BisBI = [
                      0.01          1.00996386816081
                      0.05          1.36329788395255
                       0.1           1.6084007035452
                      0.15          1.80251840078798
                       0.2          1.97775649875595
                      0.25          2.14677418880661
                       0.3          2.31694029697222
                      0.35          2.49377538655106
                       0.4          2.68228654573649
                      0.45          2.88773221152146
                       0.5          3.11627925338771
                      0.55          3.37579270829264
                       0.6          3.67700645945423
                      0.65          4.03549108449389
                       0.7          4.47529297899207
                      0.75          5.03635210577098
                       0.8          5.79154863545855
                      0.85          6.89294479838314
                       0.9          8.73401090545756
                     0.925           10.282753942238
                      0.95          12.8767013252228
                      0.97          16.9833672883061
                      0.98          21.0728531413676
                     0.985          24.5177794086554
                      0.99          30.2898141578575
                      ];
% 
% 
cap_BisBII = [
                      0.01         0.977843053277481
                      0.05          1.30551679626725
                       0.1          1.52902302142972
                      0.15          1.70433574337605
                       0.2          1.86174503550112
                      0.25          2.01318042256579
                       0.3          2.16560113627385
                      0.35          2.32425739958203
                       0.4          2.49396527277641
                      0.45           2.6798489615501
                       0.5          2.88798979336674
                      0.55           3.1262140824583
                       0.6          3.40526471287225
                      0.65          3.74077104116675
                       0.7          4.15689046962606
                      0.75          4.69372866932039
                       0.8          5.42438823136681
                      0.85          6.50121078170302
                       0.9          8.31799872472816
                     0.925          9.85482865313579
                      0.95          12.4370778905624
                      0.97          16.5345724788522
                      0.98          20.6195437919548
                     0.985          24.0622534609126
                      0.99          29.8331614615313
                      ];
% 
% 
figure
plot(cap_BisC(:,1),cap_BisC(:,2),'-or','LineWidth',1.2)
hold on
plot(cap_BisBI(:,1),cap_BisBI(:,2),'-vb','LineWidth',1.2)
plot(cap_BisBII(:,1),cap_BisBII(:,2),'-pk','LineWidth',1.2)

legend({'$B=\bf{C}$','$B=B_I$','$B=B_{II}$'},...
        'FontSize',14,'Interpreter','latex','Location','northwest');
xlabel('{$r$}','FontSize',14,'Interpreter','latex');
ylabel('{Capacity}','FontSize',14,'Interpreter','latex');

set(gca,'XTick',[0:0.25:1],'FontSize',14);
set(gca,'YTick',[0:5:35]);
axis([0 1 0 35])
grid(gca,'minor')
grid on
set(gca, 'XMinorTick','on')
set(gca, 'YMinorTick','on')
ax=gca;
ax.GridAlpha=0.75;
ax.MinorGridAlpha=0.75;
set(gca,'LooseInset',get(gca,'TightInset'))
print -depsc fig_6c_cap
%%